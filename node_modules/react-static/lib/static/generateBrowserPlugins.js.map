{"version":3,"sources":["../../src/static/generateBrowserPlugins.js"],"names":["config","pluginImports","recurse","plugins","map","plugin","browserLocation","pluginIndex","indexOf","push","length","location","options","JSON","stringify","join","pluginsText","pluginImportsText","imp","index","file","targetPath","path","process","env","REACT_STATIC_PLUGINS_PATH","fs","remove","outputFile"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;4BAEe;AAAA;AAAA;AAAA;AAAA;AAAA;AAASA,YAAAA,MAAT,QAASA,MAAT;AACb;AACMC,YAAAA,aAFO,GAES,EAFT;;AAIPC,YAAAA,OAJO,GAIG,SAAVA,OAAU,CAAAC,OAAO;AAAA,qBACrB;AADqB,2BAEjBA,OAAO,CACRC,GADC,CACG,UAAAC,MAAM,EAAI;AAAA,sBACLC,eADK,GACeD,MADf,CACLC,eADK,EAGb;;AACA,sBAAIC,WAAW,GAAGD,eAAe,GAC7BL,aAAa,CAACO,OAAd,CAAsBF,eAAtB,CAD6B,GAE7B,CAAC,CAFL;;AAGA,sBAAIC,WAAW,KAAK,CAAC,CAAjB,IAAsBD,eAA1B,EAA2C;AACzCL,oBAAAA,aAAa,CAACQ,IAAd,CAAmB,oBAAMH,eAAN,CAAnB;AACAC,oBAAAA,WAAW,GAAGN,aAAa,CAACS,MAAd,GAAuB,CAArC;AACD;;AAVY,sBAYLC,QAZK,GAY0BN,MAZ1B,CAYLM,QAZK;AAAA,sBAYKR,OAZL,GAY0BE,MAZ1B,CAYKF,OAZL;AAAA,sBAYcS,OAZd,GAY0BP,MAZ1B,CAYcO,OAZd,EAcb;;AACA,oDACO,oBAAMD,QAAN,CADP,6BAEKT,OAAO,CAACC,OAAO,IAAI,EAAZ,CAFZ,yBAIJG,eAAe,mBAAYC,WAAZ,cAA2BM,IAAI,CAACC,SAAL,CAAeF,OAAf,CAA3B,aAJX;AAOD,iBAvBC,EAwBDG,IAxBC,CAwBI,KAxBJ,CAFiB;AAAA;AAAA,aAJV,EAgCb;;;AACMC,YAAAA,WAjCO,GAiCOd,OAAO,CAACF,MAAM,CAACG,OAAP,IAAkB,EAAnB,CAjCd,EAmCb;;AACMc,YAAAA,iBApCO,GAoCahB,aAAa,CACpCG,GADuB,CACnB,UAACc,GAAD,EAAMC,KAAN;AAAA,4CAAgCA,KAAhC,oBAA+CD,GAA/C;AAAA,aADmB,EAEvBH,IAFuB,CAElB,IAFkB,CApCb,EAwCb;;AACMK,YAAAA,IAzCO,yBA0CbH,iBA1Ca,6CA6CGD,WA7CH;AAkDPK,YAAAA,UAlDO,GAkDMC,cAAKP,IAAL,CAAUQ,OAAO,CAACC,GAAR,CAAYC,yBAAtB,CAlDN;AAAA;AAAA,mBAmDPC,iBAAGC,MAAH,CAAUN,UAAV,CAnDO;;AAAA;AAAA;AAAA,mBAoDPK,iBAAGE,UAAH,CAAcP,UAAd,EAA0BD,IAA1B,CApDO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import path from 'path'\nimport slash from 'slash'\nimport fs from 'fs-extra'\n\nexport default async ({ config }) => {\n  // A deduped list of pluginImports\n  const pluginImports = []\n\n  const recurse = plugins =>\n    // Return an array of plugins\n    `[${plugins\n      .map(plugin => {\n        const { browserLocation } = plugin\n\n        // Add the plugin to the list of pluginImports\n        let pluginIndex = browserLocation\n          ? pluginImports.indexOf(browserLocation)\n          : -1\n        if (pluginIndex === -1 && browserLocation) {\n          pluginImports.push(slash(browserLocation))\n          pluginIndex = pluginImports.length - 1\n        }\n\n        const { location, plugins, options } = plugin\n\n        // IIF to return the final plugin\n        return `{\n  location: \"${slash(location)}\",\n  plugins: ${recurse(plugins || [])},\n  hooks: ${\n    browserLocation ? `plugin${pluginIndex}(${JSON.stringify(options)})` : `{}`\n  }\n}`\n      })\n      .join(',\\n')}]`\n\n  // Create the pluginsText\n  const pluginsText = recurse(config.plugins || [])\n\n  // Create the pluginImportsText\n  const pluginImportsText = pluginImports\n    .map((imp, index) => `import plugin${index} from '${imp}'`)\n    .join('\\n')\n\n  // Create the file text\n  const file = `// Imports\n${pluginImportsText}\n\n// Plugins\nconst plugins = ${pluginsText}\n\n// Export em!\nexport default plugins`\n\n  const targetPath = path.join(process.env.REACT_STATIC_PLUGINS_PATH)\n  await fs.remove(targetPath)\n  await fs.outputFile(targetPath, file)\n}\n"],"file":"generateBrowserPlugins.js"}